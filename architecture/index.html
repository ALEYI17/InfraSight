
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../ebpf-programs/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Architecture - InfraSight</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#architecture-diagram" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="InfraSight" class="md-header__button md-logo" aria-label="InfraSight" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            InfraSight
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Architecture
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ALEYI17/InfraSight" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    InfraSight
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="InfraSight" class="md-nav__button md-logo" aria-label="InfraSight" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    InfraSight
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ALEYI17/InfraSight" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    InfraSight
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      üó∫Ô∏è Architecture Diagram
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üó∫Ô∏è Architecture Diagram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-ebpf-agents" class="md-nav__link">
    <span class="md-ellipsis">
      1. eBPF Agents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-infrasight-server" class="md-nav__link">
    <span class="md-ellipsis">
      2. InfraSight Server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-kafka-message-bus" class="md-nav__link">
    <span class="md-ellipsis">
      3. Kafka Message Bus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-detection-analytics-components" class="md-nav__link">
    <span class="md-ellipsis">
      4. Detection &amp; Analytics Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Detection &amp; Analytics Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#infrasight-sentinel-rules-engine" class="md-nav__link">
    <span class="md-ellipsis">
      üîπ InfraSight Sentinel (Rules Engine)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anomaly-detection-ml-models" class="md-nav__link">
    <span class="md-ellipsis">
      üîπ Anomaly Detection (ML Models)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-clickhouse-database" class="md-nav__link">
    <span class="md-ellipsis">
      5. ClickHouse Database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-data-analysis-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      5. Data Analysis and Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-flexibility-in-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      6. Flexibility in Deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ebpf-programs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eBPF Programs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Schema
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../crd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kubernetes CRD
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Demo
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      üó∫Ô∏è Architecture Diagram
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üó∫Ô∏è Architecture Diagram">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-ebpf-agents" class="md-nav__link">
    <span class="md-ellipsis">
      1. eBPF Agents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-infrasight-server" class="md-nav__link">
    <span class="md-ellipsis">
      2. InfraSight Server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-kafka-message-bus" class="md-nav__link">
    <span class="md-ellipsis">
      3. Kafka Message Bus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-detection-analytics-components" class="md-nav__link">
    <span class="md-ellipsis">
      4. Detection &amp; Analytics Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Detection &amp; Analytics Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#infrasight-sentinel-rules-engine" class="md-nav__link">
    <span class="md-ellipsis">
      üîπ InfraSight Sentinel (Rules Engine)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anomaly-detection-ml-models" class="md-nav__link">
    <span class="md-ellipsis">
      üîπ Anomaly Detection (ML Models)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-clickhouse-database" class="md-nav__link">
    <span class="md-ellipsis">
      5. ClickHouse Database
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-data-analysis-and-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      5. Data Analysis and Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-flexibility-in-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      6. Flexibility in Deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Architecture</h1>

<h2 id="architecture-diagram">üó∫Ô∏è Architecture Diagram</h2>
<p>The diagram below illustrates the high-level architecture of the <strong>InfraSight</strong> platform:</p>
<p><img alt="InfraSight Architecture" src="../images/infrasight.png" /></p>
<p><strong>InfraSight</strong> is designed to provide detailed monitoring and auditing of Linux systems (both standalone and within Kubernetes clusters) by collecting low-level system events using <strong>eBPF</strong>. It operates through a modular pipeline that integrates multiple components for high-performance data collection, enrichment, and storage:</p>
<h3 id="1-ebpf-agents"><strong>1. eBPF Agents</strong></h3>
<p>At the core of InfraSight are <strong>eBPF Agents</strong>, which are lightweight, kernel-level agents running on each monitored node. These agents use <strong>eBPF programs</strong> attached to various <strong>tracepoints</strong> and <strong>kprobes</strong> to capture critical system call events such as:</p>
<ul>
<li><strong><code>execve</code></strong>: Monitoring process execution (command launches).</li>
<li><strong><code>open</code></strong>: Tracking file access and modification.</li>
<li><strong><code>chmod</code></strong>: Observing file permission changes.</li>
<li><strong><code>connect</code></strong> and <strong><code>accept</code></strong>: Monitoring network connection and acceptance events.</li>
<li><strong><code>ptrace</code></strong> ‚Üí Detecting process tracing operations (debuggers, tampering, reverse engineering).</li>
<li><strong><code>mmap</code></strong> ‚Üí Tracking memory mapping activity, including suspicious RWX mappings.</li>
<li><strong><code>mount</code></strong> and <strong><code>umount</code></strong> ‚Üí Monitoring filesystem mount/unmount activity, often linked to container isolation or tampering.</li>
<li><strong><code>Resource</code></strong> ‚Üí Measuring process resource usage (CPU time, memory allocations, I/O, page faults, and process lifecycle events).</li>
<li><strong><code>SyscallFreq</code></strong> ‚Üí Aggregating syscall invocation counts per process, useful for anomaly detection based on unusual syscall usage patterns.</li>
</ul>
<p>These eBPF programs operate directly within the Linux kernel, providing efficient and real-time event tracing with minimal overhead. The <strong>eBPF Agents</strong> collect raw data, including process information, network events, and file system interactions.</p>
<h3 id="2-infrasight-server"><strong>2. InfraSight Server</strong></h3>
<p>The <strong>InfraSight Server</strong> serves as the central processing unit, receiving the raw events from the eBPF Agents. Upon receiving the data, the server performs additional enrichment, such as:</p>
<ul>
<li>Converting <strong>latency</strong> from nanoseconds to more understandable units such as milliseconds or seconds.</li>
<li>Further converting event data (e.g., converting network protocol identifiers, if necessary).</li>
<li>Formatting timestamps to <strong>ISO8601</strong> for easier readability.</li>
</ul>
<p>Once enriched, the data is stored in a high-performance, scalable database.</p>
<h3 id="3-kafka-message-bus"><strong>3. Kafka Message Bus</strong></h3>
<p><strong>Apache Kafka</strong> acts as the event distribution backbone of InfraSight. By publishing enriched eBPF events into Kafka, the platform allows multiple consumers to subscribe and process the data independently. This decouples data collection from detection and analysis, enabling scalability and modularity.</p>
<h3 id="4-detection-analytics-components"><strong>4. Detection &amp; Analytics Components</strong></h3>
<p>InfraSight provides multiple detection layers consuming data from Kafka:</p>
<h4 id="infrasight-sentinel-rules-engine">üîπ InfraSight Sentinel (Rules Engine)</h4>
<p>The <strong>InfraSight Sentinel</strong> is the rules engine that evaluates eBPF events in real time. Its goal is to detect suspicious behaviors such as fileless execution, privilege escalation, or unusual system activity.  </p>
<p>It is responsible for:
- Consuming events from Kafka produced by the InfraSight server.<br />
- Applying security rules (based on syscalls and enriched process/container context).<br />
- Generating structured alerts with detailed process, container, and user information.<br />
- Integrating seamlessly with the rest of the InfraSight ecosystem.  </p>
<h4 id="anomaly-detection-ml-models">üîπ Anomaly Detection (ML Models)</h4>
<p>InfraSight also includes <strong>machine learning‚Äìbased anomaly detection</strong> modules:</p>
<ul>
<li><strong><code>infrasight-resource</code></strong> ‚Üí Focuses on detecting anomalies in <strong>resource usage patterns</strong> (CPU, memory, faults, etc).  </li>
<li><strong><code>infrasight-syscall</code></strong> ‚Üí Detects anomalies in <strong>syscall frequency and behavior</strong>, identifying deviations from learned baselines.  </li>
</ul>
<p>These models consume Kafka events, apply per-container and global anomaly detection, and produce alerts or insights. They complement Sentinel by identifying subtle or previously unknown threats.</p>
<h3 id="5-clickhouse-database"><strong>5. ClickHouse Database</strong></h3>
<p>InfraSight uses <strong>ClickHouse</strong>, a columnar database optimized for fast analytical queries, as the backend to store and manage the collected events. ClickHouse allows efficient querying even with large volumes of data, which is essential for event-driven telemetry systems.</p>
<p>Data stored in ClickHouse includes system call events, enriched metadata, and timestamped information that can be queried and analyzed in real-time.</p>
<h3 id="5-data-analysis-and-visualization"><strong>5. Data Analysis and Visualization</strong></h3>
<p>The final step of the pipeline involves visualizing and analyzing the collected events. InfraSight supports integration with <strong>Grafana</strong> (or similar tools) to build customizable dashboards. Users can query and analyze the data stored in ClickHouse to extract valuable insights, such as:</p>
<ul>
<li><strong>Security audit logs</strong>: Understanding access to sensitive files or network connections.</li>
<li><strong>Performance monitoring</strong>: Tracking resource usage by processes, network, and file system.</li>
<li><strong>Anomaly detection</strong>: Identifying unusual patterns of behavior based on syscall events.</li>
</ul>
<h3 id="6-flexibility-in-deployment"><strong>6. Flexibility in Deployment</strong></h3>
<p>This architecture is designed to work both in standalone Linux environments and in Kubernetes clusters. The modularity allows easy deployment:</p>
<ul>
<li><strong>On Kubernetes</strong>: The controller (<code>infrasight-controller</code>) can be used to deploy eBPF agents (as DaemonSets), manage their configuration, and collect telemetry from all nodes in the cluster.</li>
<li><strong>On standalone Linux hosts</strong>: The eBPF agents can run on any Linux-based system, providing valuable insights in non-Kubernetes environments.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>